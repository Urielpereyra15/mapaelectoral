<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Mapa Electoral Argentina - Animado</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  :root {
    --neutral: #eeeeee;
    --hover-scale: 1.08;
    --hover-shadow: 0 8px 20px rgba(0,0,0,0.2);
  }

  body {
    margin:0;
    font-family: Arial, sans-serif;
    display: flex;
    gap: 20px;
    height: 100vh;
    background: #fafafa;
  }

  .map-wrap {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  svg {
    width: 90%;
    max-width: 900px;
    height: auto;
  }

  path.provincia {
    fill: var(--neutral);
    stroke: #999;
    stroke-width: 1;
    transition: transform 0.2s ease, filter 0.2s ease, fill 0.2s ease;
    cursor: pointer;
  }

  path.provincia:hover {
    transform: scale(var(--hover-scale));
    filter: drop-shadow(var(--hover-shadow));
  }

  path.selected {
    stroke: #333;
    stroke-width: 2;
    filter: drop-shadow(0 10px 25px rgba(0,0,0,0.3));
  }

  .panel {
    width: 380px;
    background: white;
    border-radius: 10px;
    padding: 16px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.06);
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .panel h1 { margin:0; font-size:18px; }
  .prov-title { font-weight:700; font-size:20px; margin-top:4px; }
  .partidos-list { display:flex; flex-direction:column; gap:6px; max-height:50vh; overflow:auto; }
  .partido-row { display:flex; gap:6px; align-items:center; padding:6px; border-radius:6px; background:#f7f7f7; }
  .partido-row input[type="text"] { width:100px; padding:4px; border-radius:4px; border:1px solid #ccc; }
  .partido-row input[type="number"] { width:60px; padding:4px; border-radius:4px; border:1px solid #ccc; text-align:right; }
  .partido-row input[type="color"] { width:30px; height:25px; border:none; padding:0; cursor:pointer; }
  .btn { padding:4px 6px; border-radius:6px; border:none; cursor:pointer; }
  .btn-primary { background:#1f6feb; color:white; }
  .btn-ghost { background:#eee; }
</style>
</head>
<body>

<div class="map-wrap">
  <svg viewBox="0 0 640 800" id="mapSVG" aria-label="Mapa pol√≠tico de Argentina">
    <!-- Ejemplo simplificado de paths de provincias (se reemplazan con 24 paths reales) -->
    <path id="BuenosAires" class="provincia" d="M200,600 L300,600 L300,700 L200,700 Z" />
    <path id="CABA" class="provincia" d="M320,620 L340,620 L340,640 L320,640 Z" />
    <path id="Catamarca" class="provincia" d="M150,350 L200,350 L200,400 L150,400 Z" />
    <path id="Chaco" class="provincia" d="M300,200 L350,200 L350,250 L300,250 Z" />
    <path id="Chubut" class="provincia" d="M250,700 L300,700 L300,760 L250,760 Z" />
    <path id="Cordoba" class="provincia" d="M200,400 L250,400 L250,450 L200,450 Z" />
    <path id="Corrientes" class="provincia" d="M370,250 L420,250 L420,300 L370,300 Z" />
    <path id="EntreRios" class="provincia" d="M320,300 L370,300 L370,350 L320,350 Z" />
    <path id="Formosa" class="provincia" d="M370,150 L420,150 L420,200 L370,200 Z" />
    <path id="Jujuy" class="provincia" d="M300,50 L350,50 L350,100 L300,100 Z" />
    <path id="LaPampa" class="provincia" d="M180,500 L230,500 L230,550 L180,550 Z" />
    <path id="LaRioja" class="provincia" d="M150,400 L180,400 L180,450 L150,450 Z" />
    <path id="Mendoza" class="provincia" d="M100,400 L150,400 L150,450 L100,450 Z" />
    <path id="Misiones" class="provincia" d="M420,300 L460,300 L460,350 L420,350 Z" />
    <path id="Neuquen" class="provincia" d="M100,550 L150,550 L150,600 L100,600 Z" />
    <path id="RioNegro" class="provincia" d="M150,600 L200,600 L200,650 L150,650 Z" />
    <path id="Salta" class="provincia" d="M250,100 L300,100 L300,150 L250,150 Z" />
    <path id="SanJuan" class="provincia" d="M100,350 L150,350 L150,400 L100,400 Z" />
    <path id="SanLuis" class="provincia" d="M150,450 L200,450 L200,500 L150,500 Z" />
    <path id="SantaCruz" class="provincia" d="M200,760 L250,760 L250,800 L200,800 Z" />
    <path id="SantaFe" class="provincia" d="M250,300 L300,300 L300,350 L250,350 Z" />
    <path id="SantiagoDelEstero" class="provincia" d="M250,250 L300,250 L300,300 L250,300 Z" />
    <path id="TierraDelFuego" class="provincia" d="M300,800 L350,800 L350,830 L300,830 Z" />
    <path id="Tucuman" class="provincia" d="M250,150 L300,150 L300,200 L250,200 Z" />
  </svg>
</div>

<aside class="panel" id="panel">
  <h1>Mapa Electoral ‚Äî Editor</h1>
  <div class="prov-title" id="provName">‚Äî Haz click en una provincia ‚Äî</div>

  <div class="partidos-list" id="partidosList"></div>

  <div style="display:flex; gap:6px; margin-top:8px;">
    <button class="btn-ghost" id="addPartidoBtn">‚ûï Agregar</button>
    <button class="btn-ghost" id="resetProvBtn">üîÅ Reset</button>
    <button class="btn-primary" id="saveBtn">üíæ Guardar</button>
  </div>

</aside>

<script>
  const provinciasIds = [
    "BuenosAires","CABA","Catamarca","Chaco","Chubut","Cordoba","Corrientes",
    "EntreRios","Formosa","Jujuy","LaPampa","LaRioja","Mendoza","Misiones",
    "Neuquen","RioNegro","Salta","SanJuan","SanLuis","SantaCruz","SantaFe",
    "SantiagoDelEstero","TierraDelFuego","Tucuman"
  ];

  const basePartidos = [
    {nombre:"PJ", color:"#0b77c6", votos:0},
    {nombre:"UCR", color:"#e03b3b", votos:0},
    {nombre:"PRO", color:"#f4c542", votos:0},
    {nombre:"LLA", color:"#6b2da0", votos:0},
    {nombre:"FIT", color:"#6c3b31", votos:0}
  ];

  const provincias = {};
  provinciasIds.forEach(id=> provincias[id] = {partidos: JSON.parse(JSON.stringify(basePartidos)), ganador:null});

  const mapSVG = document.getElementById("mapSVG");
  const panelProvName = document.getElementById("provName");
  const partidosList = document.getElementById("partidosList");
  const addPartidoBtn = document.getElementById("addPartidoBtn");
  const resetProvBtn = document.getElementById("resetProvBtn");
  const saveBtn = document.getElementById("saveBtn");

  let provinciaSeleccionada = null;

  function calcularGanador(prov){
    const data = provincias[prov];
    let max=-1, idx=null;
    data.partidos.forEach((p,i)=>{
      if(Number(p.votos)>max){ max=Number(p.votos); idx=i; }
    });
    if(max===0) return null;
    return idx;
  }

  function actualizarMapa(){
    provinciasIds.forEach(id=>{
      const p = provincias[id];
      const path = document.getElementById(id);
      if(p.ganador===null) path.style.fill = getComputedStyle(document.documentElement).getPropertyValue('--neutral');
      else path.style.fill = p.partidos[p.ganador].color;
    });
  }

  function renderPartidosForm(prov){
    partidosList.innerHTML="";
    const data = provincias[prov];
    data.partidos.forEach((p,idx)=>{
      const row = document.createElement("div"); row.className="partido-row";
      const inName = document.createElement("input"); inName.type="text"; inName.value=p.nombre;
      inName.addEventListener("input", e=>{ provincias[prov].partidos[idx].nombre=e.target.value; recompute(prov); });
      const inColor = document.createElement("input"); inColor.type="color"; inColor.value=p.color;
      inColor.addEventListener("input", e=>{ provincias[prov].partidos[idx].color=e.target.value; recompute(prov); });
      const inVotos = document.createElement("input"); inVotos.type="number"; inVotos.min=0; inVotos.value=p.votos;
      inVotos.addEventListener("input", e=>{ provincias[prov].partidos[idx].votos=Number(e.target.value); recompute(prov); });
      row.appendChild(inName); row.appendChild(inColor); row.appendChild(inVotos);
      partidosList.appendChild(row);
    });
    addPartidoBtn.disabled = data.partidos.length>=5;
  }

  function recompute(prov){
    provincias[prov].ganador = calcularGanador(prov);
    actualizarMapa();
  }

  provinciasIds.forEach(id=>{
    const path = document.getElementById(id);
    path.addEventListener("click", ()=>{
      if(provinciaSeleccionada) document.getElementById(provinciaSeleccionada).classList.remove("selected");
      provinciaSeleccionada=id;
      path.classList.add("selected");
      panelProvName.innerText=id;
      renderPartidosForm(id);
      recompute(id);
    });
  });

  addPartidoBtn.addEventListener("click", ()=>{
    if(!provinciaSeleccionada) return alert("Seleccion√° una provincia");
    const data = provincias[provinciaSeleccionada];
    if(data.partidos.length>=5) return;
    data.partidos.push({nombre:"Nuevo", color:"#777777", votos:0});
    renderPartidosForm(provinciaSeleccionada);
    recompute(provinciaSeleccionada);
  });

  resetProvBtn.addEventListener("click", ()=>{
    if(!provinciaSeleccionada) return;
    provincias[provinciaSeleccionada] = {partidos: JSON.parse(JSON.stringify(basePartidos)), ganador:null};
    renderPartidosForm(provinciaSeleccionada);
    recompute(provinciaSeleccionada);
  });

  saveBtn.addEventListener("click", ()=>{
    if(!provinciaSeleccionada) return;
    recompute(provinciaSeleccionada);
    alert("Guardado localmente");
  });

  actualizarMapa();
</script>
</body>
</html>
